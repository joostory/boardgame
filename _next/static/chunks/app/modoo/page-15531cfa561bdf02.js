(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{9294:function(e,s,t){Promise.resolve().then(t.bind(t,630))},630:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return z}});var n,l=t(7437),a=t(5883);let i=(0,a.cn)({key:"gameOptions",default:{money:2e6,players:[{name:"참가자 1"},{name:"참가자 2"}]}}),r=(0,a.cn)({key:"currentGame",default:void 0,effects:[e=>{let{setSelf:s,onSet:t}=e;t((e,s,t)=>{if(e&&!t){var n;n=e.id,"undefined"!=typeof localStorage&&localStorage.setItem("modooGame-".concat(n),JSON.stringify(e))}})}]}),c=(0,a.cn)({key:"games",default:[],effects:[(n="modooGames",e=>{let{setSelf:s,onSet:t}=e;if("undefined"==typeof localStorage)return;let l=localStorage.getItem(n);null!=l&&s(JSON.parse(l)),t((e,s,t)=>{t?localStorage.removeItem(n):localStorage.setItem(n,JSON.stringify(e))})})]});var o=t(2265);function m(e){let{label:s,children:t}=e;return(0,l.jsxs)("div",{className:"px-0 py-6 grid grid-cols-3 gap-4 text-sm",children:[(0,l.jsx)("dt",{className:"flex justify-center items-start pt-3",children:s}),(0,l.jsx)("dd",{className:"col-span-2 text-start",children:t})]})}function d(e){let{children:s,onSubmit:t}=e;return(0,l.jsx)("form",{className:"mt-6 border-t border-gray-900",onSubmit:t,children:(0,l.jsx)("dl",{className:"divide-y divide-gray-900",children:s})})}var x=t(2066),u=t(5817);function j(){let[e,s]=(0,a.FV)(i);return(0,l.jsxs)("div",{className:"text-start grid gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("span",{children:[e.players.length," 명"]}),(0,l.jsxs)("button",{type:"button",className:"btn btn-xs ml-4 btn-primary",onClick:function(){s({...e,players:[...e.players,{name:"참여자 ".concat(e.players.length+1)}]})},children:[(0,l.jsx)(x.Z,{className:"w-4 h-4"})," 추가"]})]}),e.players.map((t,n)=>(0,l.jsxs)("div",{className:"join",children:[(0,l.jsx)("input",{className:"input input-bordered input-sm join-item w-full",value:t.name,onChange:t=>(function(t,n){let l=[...e.players];l.splice(t,1,{name:n}),s({...e,players:l})})(n,t.target.value)}),(0,l.jsx)("button",{type:"button",className:"btn btn-sm btn-error join-item",onClick:()=>(function(t){let n=[...e.players];n.splice(t,1),s({...e,players:n})})(n),children:(0,l.jsx)(u.Z,{className:"w-4 h-4"})})]},n))]})}function h(e){let{onClick:s}=e;return(0,l.jsx)("button",{type:"button",className:"btn btn-sm btn-warning",onClick:s,children:"0 원"})}function f(e){let{value:s,onClick:t}=e,n=(0,o.useMemo)(()=>s>0?"+".concat(s.toLocaleString()):s.toLocaleString(),[s]),a=(0,o.useMemo)(()=>s>0?"btn btn-sm btn-info":"btn btn-sm btn-error",[s]);return(0,l.jsxs)("button",{type:"button",className:a,onClick:()=>t(s),children:[n,"원"]})}function p(e){let{value:s,onChange:t,usePreset:n=!0,preset:a=[1e5,1e4,1e3,-1e5,-1e4,-1e3]}=e,i=(0,o.useMemo)(()=>Number(s).toLocaleString(),[s]);return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"join",children:[(0,l.jsx)("input",{type:"text",className:"input input-bordered join-item w-full text-xl",value:i,onChange:e=>{t(Number(e.target.value.replaceAll(",","")))}}),(0,l.jsx)("div",{className:"join-item flex justify-center items-center w-14 bg-base-300",children:"원"})]}),n&&(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[a.map(e=>(0,l.jsx)(f,{value:e,onClick:n=>t(s+e)},e)),(0,l.jsx)(h,{onClick:()=>t(0)})]})]})}function b(){let[e,s]=(0,a.FV)(i);return(0,l.jsx)(p,{value:e.money,onChange:function(t){s({...e,money:t})},usePreset:!1})}var N=t(7013),y=t(1872);function g(){let e=(0,a.Zl)(r),s=(0,a.sJ)(i),t=(0,a.rb)(i);return(0,l.jsxs)(d,{onSubmit:function(n){n.preventDefault(),e({id:(0,y.Z)(),started:new Date,option:s,players:s.players.map(e=>({id:(0,y.Z)(),money:s.money,name:e.name})),histories:[]}),t()},children:[(0,l.jsx)(m,{label:"시작금액",children:(0,l.jsx)(b,{})}),(0,l.jsx)(m,{label:"참여자",children:(0,l.jsx)(j,{})}),(0,l.jsx)(m,{children:(0,l.jsxs)("button",{type:"submit",className:"btn btn-primary w-full",children:[(0,l.jsx)(N.Z,{className:"h-6 w-6"})," 시작하기"]})})]})}function v(e){let{open:s,onClose:t,children:n,title:a,subTitle:i}=e,r=(0,o.useMemo)(()=>s?{opacity:1,pointerEvents:"auto"}:{},[s]);return(0,l.jsxs)("dialog",{className:"modal",style:r,children:[(0,l.jsx)("div",{className:"fixed top-0 bottom-0 left-0 right-0 backdrop-blur",onClick:t}),(0,l.jsxs)("div",{className:"modal-box",children:[a&&(0,l.jsxs)("div",{className:"px-4 sm:px-0",children:[(0,l.jsx)("h3",{className:"leading-7 text-xl",children:a}),i&&(0,l.jsx)("p",{className:"mt-1 leading-6 text-sm text-gray-500",children:i})]}),n]})]})}var w=t(7583),S=t(8314);function k(){let[e,s]=(0,a.FV)(c),t=(0,a.Zl)(r);return 0==e.length?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)("div",{className:"flex justify-center items-center my-5 mx-5",children:(0,l.jsx)("ul",{className:"divide-y divide-gray-800 w-full max-w-[640px] px-4 py-2 rounded-xl border border-gray-800",children:e.map(n=>{var a;return(0,l.jsx)("li",{className:"flex justify-between gap-x-6 py-6",children:(0,l.jsxs)("div",{className:"flex min-w-0 w-full",children:[(0,l.jsx)("div",{className:"min-w-0 flex-auto grow",children:(0,l.jsxs)("p",{className:"text-xl font-semibold leading-6",children:[(a=new Date(n.started),w.ou.fromJSDate(a).toFormat("yyyy-MM-dd HH:mm"))," 에 시작한 게임"]})}),(0,l.jsxs)("div",{className:"shrink-0 flex flex-row items-center gap-x-2",children:[(0,l.jsx)("button",{className:"btn btn-sm btn-info text-xs",onClick:()=>{t(function(e){if("undefined"==typeof localStorage)return null;let s=localStorage.getItem("modooGame-".concat(e));return s?JSON.parse(s):null}(n.id))},children:"게임보기"}),(0,l.jsx)("button",{className:"btn btn-sm btn-error",onClick:()=>(function(t){if(confirm("게임기록을 제거하시겠습니까?")){var n;s([...e].filter(e=>e.id!=t.id)),n=t.id,"undefined"!=typeof localStorage&&localStorage.removeItem("modooGame-".concat(n))}})(n),children:(0,l.jsx)(S.Z,{className:"h-4 w-4"})})]})]})},n.id)})})})}function C(){let[e,s]=(0,o.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"hero",children:(0,l.jsx)("div",{className:"hero-content",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("img",{src:"/modoo.png",className:"w-full"}),(0,l.jsx)("h1",{className:"text-2xl",children:"모두의 마블 점수 계산기"}),(0,l.jsxs)("div",{className:"mt-10",children:[(0,l.jsxs)("button",{className:"btn btn-primary btn-wide",onClick:()=>s(!0),children:[(0,l.jsx)(N.Z,{className:"h-6 w-6"})," 새로운 게임 시작하기"]}),(0,l.jsx)(v,{title:"새로운 게임 시작하기",subTitle:"새로운 게임을 시작합니다. 시작 옵션을 정해주세요.",open:e,onClose:()=>s(!1),children:(0,l.jsx)(g,{})})]})]})})}),(0,l.jsx)(k,{})]})}var Z=t(5625);let F=new Intl.NumberFormat;var I=t(432);function J(){let e=(0,a.sJ)(r);return(0,l.jsx)("div",{className:"flex justify-center my-10 mx-5",children:(0,l.jsx)("ul",{className:"timeline timeline-vertical timeline-compact px-4 w-full max-w-[640px]",children:e.histories.map((e,s)=>{var t,n;return(0,l.jsxs)("li",{style:{fontSize:12},children:[(0,l.jsx)("hr",{style:{height:10}}),(0,l.jsx)("div",{className:"timeline-start",children:(t=new Date(e.time),w.ou.fromJSDate(t).toFormat("T"))}),(0,l.jsx)("div",{className:"timeline-middle",children:(0,l.jsx)(I.Z,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{className:"timeline-end ",children:[e.fromName," -> ",e.toName," : ",(0,l.jsx)("b",{className:"text-success",children:(n=e.amount,F.format(n))})]}),(0,l.jsx)("hr",{})]},s)})})})}var D=t(9021),_=t(5924);function M(e){let{player:s}=e,[t,n]=(0,o.useState)(!1),[i,c]=(0,o.useState)(3e5),[x,u]=(0,o.useState)("bank"),[j,h]=(0,a.FV)(r),f=(0,a._8)(e=>{let{snapshot:t}=e;return async(e,n)=>{let l;function a(e,s,t){let n=e.findIndex(e=>e.id==s),l=e[n];return e.splice(n,1,{...l,money:l.money+t}),l}let i=await t.getPromise(r),c=[...i.players];a(c,s.id,-n),l="bank"!=e?a(c,e,n).name:"은행";let o=[{fromId:s.id,fromName:s.name,toId:e,toName:l,amount:n,time:new Date},...i.histories];h({...i,players:c,histories:o})}});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(D.Z,{className:"w-8 h-8 p-1 text-primary",onClick:()=>n(!0)}),t&&(0,l.jsx)(v,{title:"".concat(s.name," : 돈 보내기"),open:t,onClose:()=>n(!1),children:(0,l.jsxs)(d,{onSubmit:function(e){e.preventDefault(),f(x,i).then(()=>{console.log("done"),n(!1)})},children:[(0,l.jsx)(m,{label:"보낼 곳",children:(0,l.jsxs)("select",{className:"select select-bordered w-full",value:x,onChange:e=>u(e.target.value),children:[(0,l.jsx)("option",{value:"bank",children:"은행"}),j.players.filter(e=>e.id!=s.id).map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,l.jsx)(m,{label:"금액",children:(0,l.jsx)(p,{value:i,onChange:c})}),(0,l.jsx)(m,{children:(0,l.jsxs)("button",{type:"submit",className:"btn btn-primary w-full",children:[(0,l.jsx)(D.Z,{className:"w-6 h-6"})," 보내기"]})})]})})]})}function O(e){let{player:s}=e,[t,n]=(0,o.useState)(!1),[i,c]=(0,o.useState)(3e5),x=(0,a.Zl)(r),u=(0,a._8)(e=>{let{snapshot:t}=e;return async()=>{let e=await t.getPromise(r),n=e.players,l=n.findIndex(e=>e.id==s.id),a=n[l],c=[...n];c.splice(l,1,{...a,money:a.money+i});let o=[{fromId:"bank",fromName:"은행",toId:s.id,toName:s.name,amount:i,time:new Date},...e.histories];x({...e,players:c,histories:o})}});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(_.Z,{className:"w-8 h-8 p-1 text-accent",onClick:()=>n(!0)}),t&&(0,l.jsx)(v,{title:"".concat(s.name," : 은행에서 돈 받기"),open:t,onClose:()=>n(!1),children:(0,l.jsxs)(d,{onSubmit:function(e){e.preventDefault(),u(),n(!1)},children:[(0,l.jsx)(m,{label:"금액",children:(0,l.jsx)(p,{value:i,onChange:c})}),(0,l.jsx)(m,{children:(0,l.jsxs)("button",{type:"submit",className:"btn btn-accent w-full",children:[(0,l.jsx)(_.Z,{className:"w-6 h-6"})," 받기"]})})]})})]})}var V=t(6277);function E(e){var s;let{player:t}=e,n=(0,a.sJ)(r),i=(0,o.useMemo)(()=>{let e=[...n.players].sort((e,s)=>s.money-e.money),s=e[0],l=e[e.length-1];return t.money==s.money&&t.money>l.money},[n,t]);return(0,l.jsxs)("div",{className:"flex min-w-0 gap-x-4 w-full",children:[(0,l.jsxs)("div",{className:"min-w-0 flex-auto grow",children:[(0,l.jsxs)("div",{className:"flex w-full gap-x-2",children:[i&&(0,l.jsx)(V.Z,{className:"h-5 w-5 text-red-400"}),(0,l.jsx)("p",{className:"text-xl font-semibold leading-6",children:t.name})]}),(0,l.jsx)("p",{className:"mt-2 truncate text-3xl leading-8 text-yellow-100",children:(s=t.money,F.format(s))})]}),(0,l.jsxs)("div",{className:"shrink-0 flex flex-row items-center gap-x-1",children:[(0,l.jsx)(M,{player:t}),(0,l.jsx)(O,{player:t})]})]})}function G(){let e=(0,a.sJ)(r);return(0,l.jsx)("div",{className:"flex justify-center items-center my-5 mx-5",children:(0,l.jsx)("ul",{className:"divide-y divide-gray-800 w-full max-w-[640px] px-4 py-2 rounded-xl border border-gray-800",children:e.players.map(e=>(0,l.jsx)("li",{className:"flex justify-between gap-x-6 py-6",children:(0,l.jsx)(E,{player:e})},e.id))})})}function P(){let e=(0,a.rb)(r);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"hero",children:(0,l.jsx)("div",{className:"hero-content",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("img",{src:"/modoo.png",className:"w-full"}),(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"모두의 마블 점수 계산기"}),(0,l.jsx)("div",{className:"mt-10",children:(0,l.jsxs)("button",{className:"btn btn-warning btn-wide",onClick:e,children:[(0,l.jsx)(Z.Z,{className:"h-6 w-6"})," 게임 종료"]})})]})})}),(0,l.jsx)(G,{}),(0,l.jsx)(J,{})]})}function L(){let[e,s]=(0,a.FV)(r),[t,n]=(0,a.FV)(c);return(0,o.useEffect)(()=>{e&&0>t.findIndex(s=>s.id==e.id)&&n([...t,{id:e.id,started:e.started}])},[e,t]),(0,l.jsx)(l.Fragment,{})}function H(){return(0,a.sJ)(r)?(0,l.jsx)(P,{}):(0,l.jsx)(C,{})}function T(){return(0,l.jsxs)(a.Wh,{children:[(0,l.jsx)(L,{}),(0,l.jsx)(H,{})]})}function z(){return(0,l.jsxs)("main",{className:"min-h-screen",children:[(0,l.jsx)("div",{className:"navbar bg-base-100",children:(0,l.jsx)("a",{href:"/",className:"btn btn-ghost test-xl",children:"보드게임 도우미"})}),(0,l.jsx)(T,{})]})}}},function(e){e.O(0,[691,991,971,938,744],function(){return e(e.s=9294)}),_N_E=e.O()}]);