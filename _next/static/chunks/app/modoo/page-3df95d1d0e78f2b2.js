(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{9294:function(e,s,t){Promise.resolve().then(t.bind(t,630))},630:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return R}});var n=t(3827),l=t(2153);let a=e=>s=>{let{setSelf:t,onSet:n}=s;if("undefined"==typeof localStorage)return;let l=localStorage.getItem(e);null!=l&&t(JSON.parse(l)),n((s,t,n)=>{n?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(s))})},r=(0,l.cn)({key:"gameOptions",default:{money:2e6,players:[{name:"참가자 1"},{name:"참가자 2"}]},effects:[a("modooGameOption")]}),i=(0,l.cn)({key:"currentGame",default:void 0,effects:[e=>{let{setSelf:s,onSet:t}=e;t((e,s,t)=>{if(e&&!t){var n;n=e.id,"undefined"!=typeof localStorage&&localStorage.setItem("modooGame-".concat(n),JSON.stringify(e))}})}]}),c=(0,l.cn)({key:"games",default:[],effects:[a("modooGames")]});var o=t(4090);function m(e){let{label:s,children:t}=e;return(0,n.jsxs)("div",{className:"px-0 py-6 grid grid-cols-3 gap-4 text-sm",children:[(0,n.jsx)("dt",{className:"flex justify-center items-start pt-3",children:s}),(0,n.jsx)("dd",{className:"col-span-2 text-start",children:t})]})}function d(e){let{children:s,onSubmit:t}=e;return(0,n.jsx)("form",{className:"mt-6 border-t border-gray-900",onSubmit:t,children:(0,n.jsx)("dl",{className:"divide-y divide-gray-900",children:s})})}var x=t(1073),u=t(4762);function h(){let[e,s]=(0,l.FV)(r);return(0,n.jsxs)("div",{className:"text-start grid gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("span",{children:[e.players.length," 명"]}),(0,n.jsxs)("button",{type:"button",className:"btn btn-xs ml-4 btn-primary",onClick:function(){s({...e,players:[...e.players,{name:"참여자 ".concat(e.players.length+1)}]})},children:[(0,n.jsx)(x.Z,{className:"w-4 h-4"})," 추가"]})]}),e.players.map((t,l)=>(0,n.jsxs)("div",{className:"join",children:[(0,n.jsx)("input",{className:"input input-bordered input-sm join-item w-full",value:t.name,onChange:t=>(function(t,n){let l=[...e.players];l.splice(t,1,{name:n}),s({...e,players:l})})(l,t.target.value)}),(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-error join-item",onClick:()=>(function(t){let n=[...e.players];n.splice(t,1),s({...e,players:n})})(l),children:(0,n.jsx)(u.Z,{className:"w-4 h-4"})})]},l))]})}function j(e){let{onClick:s}=e;return(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-warning",onClick:s,children:"0 원"})}function f(e){let{value:s,onClick:t}=e,l=(0,o.useMemo)(()=>s>0?"+".concat(s.toLocaleString()):s.toLocaleString(),[s]),a=(0,o.useMemo)(()=>s>0?"btn btn-sm btn-info":"btn btn-sm btn-error",[s]);return(0,n.jsxs)("button",{type:"button",className:a,onClick:()=>t(s),children:[l,"원"]})}function p(e){let{value:s,onChange:t,usePreset:l=!0,preset:a=[1e5,1e4,1e3,-1e5,-1e4,-1e3]}=e,r=(0,o.useMemo)(()=>Number(s).toLocaleString(),[s]);return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"join",children:[(0,n.jsx)("input",{type:"text",className:"input input-bordered join-item w-full text-xl",value:r,onChange:e=>{t(Number(e.target.value.replaceAll(",","")))}}),(0,n.jsx)("div",{className:"join-item flex justify-center items-center w-14 bg-base-300",children:"원"})]}),l&&(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[a.map(e=>(0,n.jsx)(f,{value:e,onClick:n=>t(s+e)},e)),(0,n.jsx)(j,{onClick:()=>t(0)})]})]})}function N(){let[e,s]=(0,l.FV)(r);return(0,n.jsx)(p,{value:e.money,onChange:function(t){s({...e,money:t})},usePreset:!1})}var b=t(4273),y=t(1231);function g(){let e=(0,l.Zl)(i),s=(0,l.sJ)(r);return(0,n.jsxs)(d,{onSubmit:function(t){t.preventDefault(),e({id:(0,y.Z)(),started:new Date,option:s,players:s.players.map(e=>({id:(0,y.Z)(),money:s.money,name:e.name})),histories:[]})},children:[(0,n.jsx)(m,{label:"시작금액",children:(0,n.jsx)(N,{})}),(0,n.jsx)(m,{label:"참여자",children:(0,n.jsx)(h,{})}),(0,n.jsx)(m,{children:(0,n.jsxs)("button",{type:"submit",className:"btn btn-primary w-full",children:[(0,n.jsx)(b.Z,{className:"h-6 w-6"})," 시작하기"]})})]})}function v(e){let{open:s,onClose:t,children:l,title:a,subTitle:r}=e,i=(0,o.useMemo)(()=>s?{opacity:1,pointerEvents:"auto"}:{},[s]);return(0,n.jsxs)("dialog",{className:"modal",style:i,children:[(0,n.jsx)("div",{className:"fixed top-0 bottom-0 left-0 right-0 backdrop-blur",onClick:t}),(0,n.jsxs)("div",{className:"modal-box",children:[a&&(0,n.jsxs)("div",{className:"px-4 sm:px-0",children:[(0,n.jsx)("h3",{className:"leading-7 text-xl",children:a}),r&&(0,n.jsx)("p",{className:"mt-1 leading-6 text-sm text-gray-500",children:r})]}),l]})]})}var w=t(9001);function S(e){return w.ou.fromJSDate(e).toFormat("T")}var k=t(4574);function C(){let[e,s]=(0,l.FV)(c),t=(0,l.Zl)(i);return 0==e.length?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)("div",{className:"flex justify-center items-center my-5 mx-5",children:(0,n.jsx)("ul",{className:"w-full max-w-[640px]",children:e.toReversed().map(l=>{var a;return(0,n.jsx)("li",{className:"flex justify-between rounded-xl py-6 px-6 text-slate-400 transition-all shadow-lg hover:shadow-neutral-900 mb-4",children:(0,n.jsxs)("div",{className:"flex min-w-0 w-full",children:[(0,n.jsx)("div",{className:"min-w-0 flex-auto grow",children:(0,n.jsxs)("p",{className:"text-xl font-semibold leading-6",children:[(0,n.jsx)("span",{className:"mr-1 text-3xl text-yellow-600",children:(a=new Date(l.started),w.ou.fromJSDate(a).toFormat("yyyy-MM-dd"))}),(0,n.jsx)("span",{className:"text-sm mr-1 text-yellow-700",children:S(new Date(l.started))}),(0,n.jsx)("span",{className:"text-md",children:"에 시작한 게임"})]})}),(0,n.jsxs)("div",{className:"shrink-0 flex flex-row items-center gap-x-2",children:[(0,n.jsx)("button",{className:"btn btn-sm btn-info text-xs",onClick:()=>{t(function(e){if("undefined"==typeof localStorage)return null;let s=localStorage.getItem("modooGame-".concat(e));return s?JSON.parse(s):null}(l.id))},children:"게임보기"}),(0,n.jsx)("button",{className:"btn btn-sm btn-error",onClick:()=>(function(t){if(confirm("게임기록을 제거하시겠습니까?")){var n;s([...e].filter(e=>e.id!=t.id)),n=t.id,"undefined"!=typeof localStorage&&localStorage.removeItem("modooGame-".concat(n))}})(l),children:(0,n.jsx)(k.Z,{className:"h-4 w-4"})})]})]})},l.id)})})})}function Z(){let[e,s]=(0,o.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"hero",children:(0,n.jsx)("div",{className:"hero-content",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("img",{src:"/modoo.png",className:"w-full"}),(0,n.jsx)("h1",{className:"text-2xl",children:"모두의 마블 점수 계산기"}),(0,n.jsxs)("div",{className:"mt-10",children:[(0,n.jsxs)("button",{className:"btn btn-primary btn-wide",onClick:()=>s(!0),children:[(0,n.jsx)(b.Z,{className:"h-6 w-6"})," 새로운 게임 시작하기"]}),(0,n.jsx)(v,{title:"새로운 게임 시작하기",subTitle:"새로운 게임을 시작합니다. 시작 옵션을 정해주세요.",open:e,onClose:()=>s(!1),children:(0,n.jsx)(g,{})})]})]})})}),(0,n.jsx)(C,{})]})}var F=t(1445);let I=new Intl.NumberFormat;var D=t(8842);function J(){let e=(0,l.sJ)(i);return(0,n.jsx)("div",{className:"flex justify-center my-10 mx-5",children:(0,n.jsx)("ul",{className:"timeline timeline-vertical timeline-compact px-4 w-full max-w-[640px]",children:e.histories.map((e,s)=>{var t;return(0,n.jsxs)("li",{style:{fontSize:12},children:[(0,n.jsx)("hr",{style:{height:10}}),(0,n.jsx)("div",{className:"timeline-start",children:S(new Date(e.time))}),(0,n.jsx)("div",{className:"timeline-middle",children:(0,n.jsx)(D.Z,{className:"h-5 w-5"})}),(0,n.jsxs)("div",{className:"timeline-end ",children:[e.fromName," -> ",e.toName," : ",(0,n.jsx)("b",{className:"text-success",children:(t=e.amount,I.format(t))})]}),(0,n.jsx)("hr",{})]},s)})})})}var O=t(9599),_=t(6255);function M(e){let{player:s}=e,[t,a]=(0,o.useState)(!1),[r,c]=(0,o.useState)(3e5),[x,u]=(0,o.useState)("bank"),[h,j]=(0,l.FV)(i),f=(0,l._8)(e=>{let{snapshot:t}=e;return async(e,n)=>{let l;function a(e,s,t){let n=e.findIndex(e=>e.id==s),l=e[n];return e.splice(n,1,{...l,money:l.money+t}),l}let r=await t.getPromise(i),c=[...r.players];a(c,s.id,-n),l="bank"!=e?a(c,e,n).name:"은행";let o=[{fromId:s.id,fromName:s.name,toId:e,toName:l,amount:n,time:new Date},...r.histories];j({...r,players:c,histories:o})}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(O.Z,{className:"w-8 h-8 p-1 text-primary",onClick:()=>a(!0)}),t&&(0,n.jsx)(v,{title:"".concat(s.name," : 돈 보내기"),open:t,onClose:()=>a(!1),children:(0,n.jsxs)(d,{onSubmit:function(e){e.preventDefault(),f(x,r).then(()=>{console.log("done"),a(!1)})},children:[(0,n.jsx)(m,{label:"보낼 곳",children:(0,n.jsxs)("select",{className:"select select-bordered w-full",value:x,onChange:e=>u(e.target.value),children:[(0,n.jsx)("option",{value:"bank",children:"은행"}),h.players.filter(e=>e.id!=s.id).map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,n.jsx)(m,{label:"금액",children:(0,n.jsx)(p,{value:r,onChange:c})}),(0,n.jsx)(m,{children:(0,n.jsxs)("button",{type:"submit",className:"btn btn-primary w-full",children:[(0,n.jsx)(O.Z,{className:"w-6 h-6"})," 보내기"]})})]})})]})}function G(e){let{player:s}=e,[t,a]=(0,o.useState)(!1),[r,c]=(0,o.useState)(3e5),x=(0,l.Zl)(i),u=(0,l._8)(e=>{let{snapshot:t}=e;return async()=>{let e=await t.getPromise(i),n=e.players,l=n.findIndex(e=>e.id==s.id),a=n[l],c=[...n];c.splice(l,1,{...a,money:a.money+r});let o=[{fromId:"bank",fromName:"은행",toId:s.id,toName:s.name,amount:r,time:new Date},...e.histories];x({...e,players:c,histories:o})}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_.Z,{className:"w-8 h-8 p-1 text-accent",onClick:()=>a(!0)}),t&&(0,n.jsx)(v,{title:"".concat(s.name," : 은행에서 돈 받기"),open:t,onClose:()=>a(!1),children:(0,n.jsxs)(d,{onSubmit:function(e){e.preventDefault(),u(),a(!1)},children:[(0,n.jsx)(m,{label:"금액",children:(0,n.jsx)(p,{value:r,onChange:c})}),(0,n.jsx)(m,{children:(0,n.jsxs)("button",{type:"submit",className:"btn btn-accent w-full",children:[(0,n.jsx)(_.Z,{className:"w-6 h-6"})," 받기"]})})]})})]})}var V=t(7759);function E(e){var s;let{player:t}=e,a=(0,l.sJ)(i),r=(0,o.useMemo)(()=>{let e=[...a.players].sort((e,s)=>s.money-e.money),s=e[0],n=e[e.length-1];return t.money==s.money&&t.money>n.money},[a,t]);return(0,n.jsxs)("div",{className:"flex min-w-0 gap-x-4 w-full",children:[(0,n.jsxs)("div",{className:"min-w-0 flex-auto grow",children:[(0,n.jsxs)("div",{className:"flex w-full gap-x-2",children:[r&&(0,n.jsx)(V.Z,{className:"h-5 w-5 text-red-400"}),(0,n.jsx)("p",{className:"text-xl font-semibold leading-6",children:t.name})]}),(0,n.jsx)("p",{className:"mt-2 truncate text-3xl leading-8 text-yellow-100",children:(s=t.money,I.format(s))})]}),(0,n.jsxs)("div",{className:"shrink-0 flex flex-row items-center gap-x-1",children:[(0,n.jsx)(M,{player:t}),(0,n.jsx)(G,{player:t})]})]})}function P(){let e=(0,l.sJ)(i);return(0,n.jsx)("div",{className:"flex justify-center items-center my-5 mx-5",children:(0,n.jsx)("ul",{className:"divide-y divide-gray-800 w-full max-w-[640px] px-4 py-2 rounded-xl border border-gray-800",children:e.players.map(e=>(0,n.jsx)("li",{className:"flex justify-between gap-x-6 py-6",children:(0,n.jsx)(E,{player:e})},e.id))})})}function L(){let e=(0,l.rb)(i);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"hero",children:(0,n.jsx)("div",{className:"hero-content",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("img",{src:"/modoo.png",className:"w-full"}),(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"모두의 마블 점수 계산기"}),(0,n.jsx)("div",{className:"mt-10",children:(0,n.jsxs)("button",{className:"btn btn-warning btn-wide",onClick:e,children:[(0,n.jsx)(F.Z,{className:"h-6 w-6"})," 게임 종료"]})})]})})}),(0,n.jsx)(P,{}),(0,n.jsx)(J,{})]})}function T(){let[e,s]=(0,l.FV)(i),[t,a]=(0,l.FV)(c);return(0,o.useEffect)(()=>{e&&0>t.findIndex(s=>s.id==e.id)&&a([...t,{id:e.id,started:e.started}])},[e,t]),(0,n.jsx)(n.Fragment,{})}function z(){return(0,l.sJ)(i)?(0,n.jsx)(L,{}):(0,n.jsx)(Z,{})}function A(){return(0,n.jsxs)(l.Wh,{children:[(0,n.jsx)(T,{}),(0,n.jsx)(z,{})]})}function R(){return(0,n.jsxs)("main",{className:"min-h-screen",children:[(0,n.jsx)("div",{className:"navbar bg-base-100",children:(0,n.jsx)("a",{href:"/",className:"btn btn-ghost test-xl",children:"보드게임 도우미"})}),(0,n.jsx)(A,{})]})}}},function(e){e.O(0,[691,910,971,69,744],function(){return e(e.s=9294)}),_N_E=e.O()}]);