(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{9294:function(e,s,t){Promise.resolve().then(t.bind(t,7415))},7415:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return V}});var n=t(7437),l=t(5883);let a=(0,l.cn)({key:"gameOptions",default:{money:2e6,players:[{name:"참가자 1"},{name:"참가자 2"}]}});function i(){return"undefined"==typeof localStorage?[]:JSON.parse(localStorage.getItem("mooduGames")||"[]")}let r=(0,l.cn)({key:"currentGame",default:void 0,effects:[e=>{let{setSelf:s,onSet:t}=e;t((e,s,t)=>{if(console.log("currentGame",e,s,t),e&&!t){if(!s){var n;let s=i();0>s.findIndex(s=>s.id==e.id)&&(n=[...s,{id:e.id,started:e.started}],"undefined"!=typeof localStorage&&localStorage.setItem("mooduGames",JSON.stringify(n)))}localStorage.setItem("mooduGame-".concat(e.id),JSON.stringify(e))}})}]}),c=(0,l.nZ)({key:"games",get:e=>{let{get:s}=e;return i()}});var o=t(2265);function m(e){let{label:s,children:t}=e;return(0,n.jsxs)("div",{className:"px-0 py-6 grid grid-cols-3 gap-4 text-sm",children:[(0,n.jsx)("dt",{className:"flex justify-center items-start pt-3",children:s}),(0,n.jsx)("dd",{className:"col-span-2 text-start",children:t})]})}function d(e){let{children:s,onSubmit:t}=e;return(0,n.jsx)("form",{className:"mt-6 border-t border-gray-900",onSubmit:t,children:(0,n.jsx)("dl",{className:"divide-y divide-gray-900",children:s})})}var x=t(2066),u=t(5817);function j(){let[e,s]=(0,l.FV)(a);return(0,n.jsxs)("div",{className:"text-start grid gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("span",{children:[e.players.length," 명"]}),(0,n.jsxs)("button",{type:"button",className:"btn btn-xs ml-4 btn-primary",onClick:function(){s({...e,players:[...e.players,{name:"참여자 ".concat(e.players.length+1)}]})},children:[(0,n.jsx)(x.Z,{className:"w-4 h-4"})," 추가"]})]}),e.players.map((t,l)=>(0,n.jsxs)("div",{className:"join",children:[(0,n.jsx)("input",{className:"input input-bordered input-sm join-item w-full",value:t.name,onChange:t=>(function(t,n){let l=[...e.players];l.splice(t,1,{name:n}),s({...e,players:l})})(l,t.target.value)}),(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-error join-item",onClick:()=>(function(t){let n=[...e.players];n.splice(t,1),s({...e,players:n})})(l),children:(0,n.jsx)(u.Z,{className:"w-4 h-4"})})]},l))]})}function h(e){let{onClick:s}=e;return(0,n.jsx)("button",{type:"button",className:"btn btn-sm btn-warning",onClick:s,children:"0 원"})}function f(e){let{value:s,onClick:t}=e,l=(0,o.useMemo)(()=>s>0?"+".concat(s.toLocaleString()):s.toLocaleString(),[s]),a=(0,o.useMemo)(()=>s>0?"btn btn-sm btn-info":"btn btn-sm btn-error",[s]);return(0,n.jsxs)("button",{type:"button",className:a,onClick:()=>t(s),children:[l,"원"]})}function p(e){let{value:s,onChange:t,usePreset:l=!0,preset:a=[1e5,1e4,1e3,-1e5,-1e4,-1e3]}=e,i=(0,o.useMemo)(()=>Number(s).toLocaleString(),[s]);return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"join",children:[(0,n.jsx)("input",{type:"text",className:"input input-bordered join-item w-full text-xl",value:i,onChange:e=>{t(Number(e.target.value.replaceAll(",","")))}}),(0,n.jsx)("div",{className:"join-item flex justify-center items-center w-14 bg-base-300",children:"원"})]}),l&&(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[a.map(e=>(0,n.jsx)(f,{value:e,onClick:n=>t(s+e)},e)),(0,n.jsx)(h,{onClick:()=>t(0)})]})]})}function b(){let[e,s]=(0,l.FV)(a);return(0,n.jsx)(p,{value:e.money,onChange:function(t){s({...e,money:t})},usePreset:!1})}var N=t(7013),y=t(1872);function g(){let e=(0,l.Zl)(r),s=(0,l.sJ)(a),t=(0,l.rb)(a);return(0,n.jsxs)(d,{onSubmit:function(n){n.preventDefault(),e({id:(0,y.Z)(),started:new Date,option:s,players:s.players.map(e=>({id:(0,y.Z)(),money:s.money,name:e.name})),histories:[]}),t()},children:[(0,n.jsx)(m,{label:"시작금액",children:(0,n.jsx)(b,{})}),(0,n.jsx)(m,{label:"참여자",children:(0,n.jsx)(j,{})}),(0,n.jsx)(m,{children:(0,n.jsxs)("button",{type:"submit",className:"btn btn-primary w-full",children:[(0,n.jsx)(N.Z,{className:"h-6 w-6"})," 시작하기"]})})]})}function v(e){let{open:s,onClose:t,children:l,title:a,subTitle:i}=e,r=(0,o.useMemo)(()=>s?{opacity:1,pointerEvents:"auto"}:{},[s]);return(0,n.jsxs)("dialog",{className:"modal",style:r,children:[(0,n.jsx)("div",{className:"fixed top-0 bottom-0 left-0 right-0 backdrop-blur",onClick:t}),(0,n.jsxs)("div",{className:"modal-box",children:[a&&(0,n.jsxs)("div",{className:"px-4 sm:px-0",children:[(0,n.jsx)("h3",{className:"leading-7 text-xl",children:a}),i&&(0,n.jsx)("p",{className:"mt-1 leading-6 text-sm text-gray-500",children:i})]}),l]})]})}var w=t(7583);function S(){let e=(0,l.sJ)(c),s=(0,l.Zl)(r);return 0==e.length?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)("div",{className:"flex justify-center items-center my-5 mx-5",children:(0,n.jsx)("ul",{className:"divide-y divide-gray-800 w-full max-w-[640px] px-4 py-2 rounded-xl border border-gray-800",children:e.map(e=>{var t;return(0,n.jsx)("li",{className:"flex justify-between gap-x-6 py-6",children:(0,n.jsxs)("div",{className:"flex min-w-0 w-full",children:[(0,n.jsx)("div",{className:"min-w-0 flex-auto grow",children:(0,n.jsxs)("p",{className:"text-xl font-semibold leading-6",children:[(t=new Date(e.started),w.ou.fromJSDate(t).toFormat("yyyy-MM-dd HH:mm"))," 에 시작한 게임"]})}),(0,n.jsx)("div",{className:"shrink-0 flex flex-row items-center gap-x-1",children:(0,n.jsx)("button",{className:"btn btn-sm btn-info",onClick:()=>{s(function(e){if("undefined"==typeof localStorage)return null;let s=localStorage.getItem("mooduGame-".concat(e));return s?JSON.parse(s):null}(e.id))},children:"게임보기"})})]})},e.id)})})})}function k(){let[e,s]=(0,o.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"hero",children:(0,n.jsx)("div",{className:"hero-content",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("img",{src:"/modoo.png",className:"w-full"}),(0,n.jsx)("h1",{className:"text-2xl",children:"모두의 마블 점수 계산기"}),(0,n.jsxs)("div",{className:"mt-10",children:[(0,n.jsxs)("button",{className:"btn btn-primary btn-wide",onClick:()=>s(!0),children:[(0,n.jsx)(N.Z,{className:"h-6 w-6"})," 시작하기"]}),(0,n.jsx)(v,{title:"새로운 게임 시작하기",subTitle:"새로운 게임을 시작합니다. 시작 옵션을 정해주세요.",open:e,onClose:()=>s(!1),children:(0,n.jsx)(g,{})})]})]})})}),(0,n.jsx)(S,{})]})}var C=t(5625);let Z=new Intl.NumberFormat;var I=t(432);function F(){let e=(0,l.sJ)(r);return(0,n.jsx)("div",{className:"flex justify-center my-10 mx-5",children:(0,n.jsx)("ul",{className:"timeline timeline-vertical timeline-compact px-4 w-full max-w-[640px]",children:e.histories.map((e,s)=>{var t,l;return(0,n.jsxs)("li",{style:{fontSize:12},children:[(0,n.jsx)("hr",{style:{height:10}}),(0,n.jsx)("div",{className:"timeline-start",children:(t=new Date(e.time),w.ou.fromJSDate(t).toFormat("T"))}),(0,n.jsx)("div",{className:"timeline-middle",children:(0,n.jsx)(I.Z,{className:"h-5 w-5"})}),(0,n.jsxs)("div",{className:"timeline-end ",children:[e.fromName," -> ",e.toName," : ",(0,n.jsx)("b",{className:"text-success",children:(l=e.amount,Z.format(l))})]}),(0,n.jsx)("hr",{})]},s)})})})}var J=t(9021),D=t(5924);function _(e){let{player:s}=e,[t,a]=(0,o.useState)(!1),[i,c]=(0,o.useState)(3e5),[x,u]=(0,o.useState)("bank"),[j,h]=(0,l.FV)(r),f=(0,l._8)(e=>{let{snapshot:t}=e;return async(e,n)=>{let l;function a(e,s,t){let n=e.findIndex(e=>e.id==s),l=e[n];return e.splice(n,1,{...l,money:l.money+t}),l}let i=await t.getPromise(r),c=[...i.players];a(c,s.id,-n),l="bank"!=e?a(c,e,n).name:"은행";let o=[{fromId:s.id,fromName:s.name,toId:e,toName:l,amount:n,time:new Date},...i.histories];h({...i,players:c,histories:o})}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(J.Z,{className:"w-8 h-8 p-1 text-primary",onClick:()=>a(!0)}),t&&(0,n.jsx)(v,{title:"".concat(s.name," : 돈 보내기"),open:t,onClose:()=>a(!1),children:(0,n.jsxs)(d,{onSubmit:function(e){e.preventDefault(),f(x,i).then(()=>{console.log("done"),a(!1)})},children:[(0,n.jsx)(m,{label:"보낼 곳",children:(0,n.jsxs)("select",{className:"select select-bordered w-full",value:x,onChange:e=>u(e.target.value),children:[(0,n.jsx)("option",{value:"bank",children:"은행"}),j.players.filter(e=>e.id!=s.id).map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,n.jsx)(m,{label:"금액",children:(0,n.jsx)(p,{value:i,onChange:c})}),(0,n.jsx)(m,{children:(0,n.jsxs)("button",{type:"submit",className:"btn btn-primary w-full",children:[(0,n.jsx)(J.Z,{className:"w-6 h-6"})," 보내기"]})})]})})]})}function O(e){let{player:s}=e,[t,a]=(0,o.useState)(!1),[i,c]=(0,o.useState)(3e5),x=(0,l.Zl)(r),u=(0,l._8)(e=>{let{snapshot:t}=e;return async()=>{let e=await t.getPromise(r),n=e.players,l=n.findIndex(e=>e.id==s.id),a=n[l],c=[...n];c.splice(l,1,{...a,money:a.money+i});let o=[{fromId:"bank",fromName:"은행",toId:s.id,toName:s.name,amount:i,time:new Date},...e.histories];x({...e,players:c,histories:o})}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D.Z,{className:"w-8 h-8 p-1 text-accent",onClick:()=>a(!0)}),t&&(0,n.jsx)(v,{title:"".concat(s.name," : 은행에서 돈 받기"),open:t,onClose:()=>a(!1),children:(0,n.jsxs)(d,{onSubmit:function(e){e.preventDefault(),u(),a(!1)},children:[(0,n.jsx)(m,{label:"금액",children:(0,n.jsx)(p,{value:i,onChange:c})}),(0,n.jsx)(m,{children:(0,n.jsxs)("button",{type:"submit",className:"btn btn-accent w-full",children:[(0,n.jsx)(D.Z,{className:"w-6 h-6"})," 받기"]})})]})})]})}function G(e){var s;let{player:t}=e;return(0,n.jsxs)("div",{className:"flex min-w-0 gap-x-4 w-full",children:[(0,n.jsxs)("div",{className:"min-w-0 flex-auto grow",children:[(0,n.jsx)("p",{className:"text-xl font-semibold leading-6",children:t.name}),(0,n.jsx)("p",{className:"mt-2 truncate text-3xl leading-8",children:(s=t.money,Z.format(s))})]}),(0,n.jsxs)("div",{className:"shrink-0 flex flex-row items-center gap-x-1",children:[(0,n.jsx)(_,{player:t}),(0,n.jsx)(O,{player:t})]})]})}function M(){let e=(0,l.sJ)(r);return(0,n.jsx)("div",{className:"flex justify-center items-center my-5 mx-5",children:(0,n.jsx)("ul",{className:"divide-y divide-gray-800 w-full max-w-[640px] px-4 py-2 rounded-xl border border-gray-800",children:e.players.map(e=>(0,n.jsx)("li",{className:"flex justify-between gap-x-6 py-6",children:(0,n.jsx)(G,{player:e})},e.id))})})}function E(){let e=(0,l.rb)(r);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"hero",children:(0,n.jsx)("div",{className:"hero-content",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("img",{src:"/modoo.png",className:"w-full"}),(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"모두의 마블 점수 계산기"}),(0,n.jsx)("div",{className:"mt-10",children:(0,n.jsxs)("button",{className:"btn btn-warning btn-wide",onClick:e,children:[(0,n.jsx)(C.Z,{className:"h-6 w-6"})," 게임 종료"]})})]})})}),(0,n.jsx)(M,{}),(0,n.jsx)(F,{})]})}function P(){return(0,l.sJ)(r)?(0,n.jsx)(E,{}):(0,n.jsx)(k,{})}function L(){return(0,n.jsx)(l.Wh,{children:(0,n.jsx)(P,{})})}function V(){return(0,n.jsxs)("main",{className:"min-h-screen",children:[(0,n.jsx)("div",{className:"navbar bg-base-100",children:(0,n.jsx)("a",{href:"/",className:"btn btn-ghost test-xl",children:"보드게임 도우미"})}),(0,n.jsx)(L,{})]})}}},function(e){e.O(0,[691,471,971,938,744],function(){return e(e.s=9294)}),_N_E=e.O()}]);